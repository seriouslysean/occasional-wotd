---
import Heading from '~components/Heading.astro';
import SectionHeading from '~components/SectionHeading.astro';
import WordList from '~components/WordList.astro';
import Layout from '~layouts/Layout.astro';
import { getPageMetadata } from '~utils-client/page-metadata.ts';
import { formatWordCount } from '~utils-client/text-utils';
import { getWordsFromCollection, groupWordsByLength } from '~utils-client/word-data-utils';

const allWords = await getWordsFromCollection();
const wordsByLength = groupWordsByLength(allWords);
const lengths = Object.keys(wordsByLength)
  .map(Number)
  .sort((a, b) => a - b);
const { title, description } = getPageMetadata(Astro.url.pathname);
---

<Layout title={title} description={description}>
  <main class="length-words">
    <Heading text={title} />
    {lengths.map(length => (
      <section class="length-words__section">
        <SectionHeading
          text={`${length}-letter words (${formatWordCount(wordsByLength[length].length)})`}
          href={`/words/length/${length}`}
        />
        <WordList words={wordsByLength[length]} columns={2} />
      </section>
    ))}
  </main>
</Layout>

<style>
  .length-words {
    max-width: var(--content-width-medium);
    margin: 0 auto;
  }

  .length-words__section {
    margin-bottom: var(--spacing-large);
  }
</style>

