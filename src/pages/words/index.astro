---
import Heading from '~components/Heading.astro';
import WordSection from '~components/WordSection.astro';
import Layout from '~layouts/Layout.astro';
import { getPageMetadata } from '~utils-client/page-metadata.ts';
import { STRUCTURED_DATA_TYPE } from '~utils-client/schema-utils.ts';
import { formatWordCount } from '~utils-client/text-utils';
import { getWordsFromCollection, groupWordsByYear } from '~utils-client/word-data-utils';

const allWords = await getWordsFromCollection();
const wordsByYear = groupWordsByYear(allWords);
const { title, description } = getPageMetadata(Astro.url.pathname);
---

<Layout title={title} description={description} structuredDataType={STRUCTURED_DATA_TYPE.WORD_LIST}>
  <main class="words">
    <Heading text={title} secondaryText={formatWordCount(allWords.length)} />
    {(Object.entries(wordsByYear) as [string, typeof allWords][]).reverse().map(([year, words]) => (
      <WordSection title={year} href={`/words/${year}`} words={words} />
    ))}
  </main>
</Layout>

<style>
    .words {
        max-width: var(--content-width-medium);
        margin: 0 auto;
    }

</style>
