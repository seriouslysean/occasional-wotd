---
import WordComponent from '~components/Word.astro';
import WordNav from '~components/WordNav.astro';
import Layout from '~layouts/Layout.astro';
import type { WordData } from '~types/word';
import { STRUCTURED_DATA_TYPE } from '~astro-utils/schema-utils.ts';
import { getMetaDescription } from '~astro-utils/seo-utils.ts';
import { extractWordDefinition } from '~astro-utils/word-data-utils';

interface Props {
  wordData: WordData;
  previousWord?: WordData | null;
  nextWord?: WordData | null;
  structuredDataType?: string;
}

const { wordData, previousWord, nextWord, structuredDataType = STRUCTURED_DATA_TYPE.WORD_SINGLE } = Astro.props;

if (!wordData) {
  return Astro.redirect('/404');
}

// Extract definition using shared utility
const { definition } = extractWordDefinition(wordData);
const pageDescription = getMetaDescription({
  word: wordData.word,
  definition,
});
---

<Layout
  title={wordData.word}
  word={wordData}
  description={pageDescription}
  structuredDataType={structuredDataType}
>

    <WordComponent word={wordData} />
    <WordNav
      previousWord={previousWord}
      nextWord={nextWord}
      previousLabel="Previous Word"
      nextLabel="Next Word"
      ariaLabel="Word navigation"
    />

</Layout>
